<html>
<head>
<title>What's New in Synchronet v3.14 (Change History)</title>
</head>
<body>
<font face=Arial,Helvetica>
<h1 align=center>What's New in Synchronet v3.14</h1>
<ul>
<li><b>All Servers</b><ul>
	<li>Startup file (<tt>ctrl/sbbs.ini</tt>) now supports <tt>!include <i>filename</i></tt> directive to
		nest initialization files
	<li>Support per-server/service/protocol socket option settings in <tt>ctrl/sockopts.ini</tt>
		(<b>replacing <tt>sockopts.cfg</tt></b>)
		<br>
		For example, a section named <tt>[telnet|rlogin]</tt> would set the socket options for either
		Telnet <i>or</i> RLogin sessions, while <tt>[telnet]</tt> would set the socket options <i>only</i> for 
		Telnet sessions
		<br>
		Automatically reads a <tt>[tcp]</tt> or <tt>[udp]</tt> section, if it exists (based on the socket type)
			
	<li>Bug-fixes in ARS compilation:<ul>
		<li>Wasn't accounting for correct lengths of keywords: <i>WIN32, UNIX, LINUX,</i> and <i>PROT</i>
		<li>Didn't support >8 char internal codes in <i>SUBCODE</i> and <i>DIRCODE</i> values
		<li>Would skip pass the line (null) terminator causing stack corruption or crash
			when parsing values for <i>SUBCODE</i>, <i>DIRCODE</i>, or <i>SHELL</i> keywords as the last
			keyword
		</ul>
	<li>Bug-fix: buffer overflow if global QWKnet tagline is > 80 characters in length
	<li>Added support for ARS Keywords: <i>GROUP, SUB, SUBCODE, LIB, DIR,</i> and <i>DIRCODE</i><br>
		These ARS keywords were previously only supported in the Telnet/RLogin server
	</ul><br>
<li><b>Web Server</b><ul>
	<li>Support new <tt>webctrl.ini</tt> files (optional access control and configuration files sprinkled through-out the <tt>web/root</tt> hierarchy)<br>
		This allows overriding server settings on a per-directory or per-filespec basis.<br>
		Allowed keys are:<ul>
			<li><tt>ErrorDirectory</tt>	- Changes the directory where error pages are served from
			<li><tt>CGIDirectory</tt>	- Overrides the <tt>CGIDirectory</tt> value from the <tt>[web]</tt> section of the <tt>sbbs.ini</tt> file
			<li><tt>AccessRequirements</tt>	- Access Requirements String (ARS) required for this resource (Overrides <tt>access.ars</tt>)
			<li><tt>Realm</tt>		- Authentication realm name to send to remote
			</ul>
		<b>Note: <tt>access.ars</tt> usage is now deprecated</b>
	<li>Support for chunked mode <i>ssjs</i> files<br>
	    In chunked mode, data written out from
		the SSJS script is sent immediately, and the keep-alvie session is maintained.<br>
		chunked mode is ONLY sent to HTTP/1.1 clients, and is preferred over fast mode.<br>
		This means fast mode is now only usefull for HTTP/1.0 and HTTP/0.9 requests.<br>
	<li>Add in an output thread which handles chunking.  This should improve JS
		output, and prevent gobs 'o errors<br>
		This output buffering is controlled with the <tt>OutbufHighwaterMark</tt> and <tt>OutbufDrainTimeout</tt>
		values in the <tt>[web]</tt> section of the <tt>ctrl/sbbs.ini</tt> file
	<li>Default web root dir is now <tt>../web/root</tt> (changed from <tt>../web/html</tt>)
	<li>Bug-fix: Win32-CGI race condition<br>
		where the <i>exec_cgi()</i> loop could
		(sometimes) detect that the CGI process had terminated, before reading all
		the data from the stdout pipe
	<li>Fix for <i>PATH_INFO</i>-based scripts installed as an index filename in the root
		of the host.  (ie: <tt>index.cgi</tt>)<br>
		This would allow <tt>index.cgi</tt> to be (say) <tt>viewcvs.cgi</tt> and URLs such as:<br>
		<tt>http://cvs.synchro.net/src/sbbs3/websrvr.c</tt> to work
	<li>External redirects are <i>MOVED_TEMP</i>, not <i>MOVED_STAT</i>
	<li>Add <tt>REQUEST_URI</tt> CGI variable (Apache extension)
	<li>Drain STDOUT as well as STDERR
	<li>Don't drain STDIO until script is terminated
	<li>Do not send <tt>Content-length</tt> header for CGI scripts.
	<li>Properly handle partial writes of CGI output using <i>sock_sendbuf()</i>
	<li>Support FreeBSDs <i>accf_http(9)</i> kerm option/module designed specifically for
		HTTP server optimizations.
	</ul><br>
<li><b>Mail Server</b><ul>
	<li>New feature to solve a common sysop misconfiguration issue:<br>
		Automatically detect the DNS server (randomly chosen from the list of system-configured
		DNS servers) if no DNS server is configured in Synchronet.<br>
		For *nix, this assumes you have read access to <tt>/etc/resolv.conf</tt> (where da 'e'?)<br>
		For Win32, this assumes you have <tt>IPHLPAPI.DLL</tt> on your system (included with
		Win98+).
	<li>Bug-fix: do not adjust for daylight savings time when generating RFC822-compliant
		date/time strings<br>
		This caused an off-by-one-hour bug in the "Date:" header field
		of sent Internet mail when DST is in effect
	<li>Overhaul mail index loading in sendmail thread:<br>
		Don't directly access the index (<tt>.sid</tt>) file stream, reading a record at time
		with no locking.<br>
		Instead, read all the relevant index records in one safe
		locked operating (using <i>loadmail()</i>)<br>
		This should fix the multi-server heavy traffic <tt>mail.sid</tt> corruption bug
	<li>Always lock the entire message base when re-writing existing header and index
		records (using <i>smb_putmsg()</i>)<br>
		Keeps the index file from being truncated during
		the operation (nightly purging of deleted message indexes?) causing corruption
	<li>Set the SMB <i>recipient extension</i> header field when routing to QWKnet node<br>
		(this is necessary for <i>FIXSMB</i> to be able to reconstruct the index file)
	<li>Bug-fix: clear the <i>from extension</i> for bounced messages (they're not from a user)
	<li>Bug-fix: forwarding mail to a non-standard SMTP port (via the <tt>ctrl/alias.cfg</tt> file)
		no longer worked<br>
		 because the <i>":port"</i> portion of the destination address wasn't being removed
	<li>Enhancement: only perform MX-record lookup if no port number specified in destination domain
		portion of recipient e-mail address
	<li>Enhancement: don't attempt to send to MX servers with an IP address of <i>0.0.0.0</i>
	<li>Bug-fix: memory leak when parsing <tt>ctrl/mailproc.ini</tt>, caught by valgrind
	</ul><br>
<li><b>FTP Server</b><ul>
	<li>New option: Lookup Passive IP<br>
		Enabled by adding <tt>LOOKUP_PASV_IP</tt> to the <tt>Options</tt> value in the <tt>[ftp]</tt> section
		of the <tt>ctrl/sbbs.ini</tt> file:<br>
		This option tells the FTP server to perform a hostname lookup (on the BBS's
		hostname) to determine the correct/current public IP address to use in
		<i>PASV</i> responses<br>
		This is one more kludge to work around stupid NAT devices
		(consumer firewalls/routers)
	<li><i>Failed Login</i> verbiage is now configurable by creating the optional text file:
		<tt>text/ftpbadlogin.txt</tt>
	<li>Bug-fix: added support for <tt>%@</tt> command-line specifier<br>
		(used in <i>Extractable File Type</i> command-lines)
	</ul><br>
<li><b>Telnet/RLogin Server</b><ul>
	<li>When reading messages and updating existing message header and index records,
	always lock the entire message base - preventing corruption
	<li>When replying to a message, if the posting user was the author of the original message, 
		use the original message's recipient as the recipient of the new reply message as well
		(no need to post "to" yourself)
	<li>Bug-fix: uninitialized pointer dereference in temporary file section
	<li>Bug-fix: split-screen chat corruption
	<li>Bug-fix: do not adjust for daylight savings time when generating QWK and Fido date/time stamps<br>
	<li>Bug-fix: do not adjust for daylight savings time when calculating time until next event
	<li>Bug-fix: ignore disabled events when calculating time until next event
	<li>Bug-fix: bad drop file path if using startup-dir (e.g. <tt>c:\sbbs\xtrn\game\/door.sys</tt>)
	<li>Bug-fix: <tt>data/hungup.log</tt> wasn't being updated
	<li>Bug-fix: exceptions occurring in JS script run from another JS script would not be reported to the console/log
	<li>Bug-fix: report JS script compilation errors (exceptions) immediately
	<li>Telegard and Renegade "pipe codes" actually must have 2 decimal
		digits<br>
		This will reduce the liklihood of false-positive TG/RG pipe code
		interpretation
	<li>ANSI output optimization (combine attribute changes into a single ESC[m code):<br>
			<tt>ESC[0;1;5;32;40m</tt><br>
			Is shorter than:<br>
			<tt>ESC[0mESC[1mESC[5mESC[32mESC[40m</tt><br>
			...by about eight chars.<br>
	<li>Include QWK text files (e.g. <tt>HELLO, GOODBYE, BBSNEWS, BLT-*</tt>) when prepacking
		QWK packets (or packing for FTP download)
	<li>Introduced <tt>K_NOSPIN</tt> mode flag for <i>getkey()</i><br>
		to over-ride (temporarily disable) user's spinning cursor setting
	<li>Don't use the SyncTerm/RLogin "password" parameter for new user accounts unless it meets
		minimum secure-password requirements<br>
		(e.g. isn't the same as the user's name or alias)
	<li>Bug-fix: delete environment variables from the
		processes environment block when adding new environment strings<br>
		otherwise, existing values (for say "SBBSNODE") would not be over-ridden<br>
		This was cause of the well-known <i>DoorMUD</i> incompatibility with v3.13a.
	<li>If a file name doesn't include a suffix/extension in the native program list,
		then any command-line executing a program with the same base filename will
		be considered "native"<br>
		(e.g. <tt>"unzip.exe"</tt> will be considered native if <tt>"unzip"</tt>
		is in the native program list)
	<li>When executing a module via <tt>"*modname ..."</tt>, with <i>no file extension</i>
		specified<br>
		if <tt>modname.js</tt> exists, it will be executed instead of <tt>modname.bin</tt><br>
		Previously, the <tt>.bin</tt> extension was always assumed if it wasn't specified on
		the command-line<br>
		This modification allows <tt>exec/bullseye.js</tt> to take
		precedence over <tt>exec/bullseye.bin</tt> without any change to the command-line
		configuration<br>
		Execute <tt>"*modname.bin"</tt> if you want to specifically execute
		<tt>modname.bin</tt> and not <tt>modname.js</tt> (if it exists)
	<li>External program yielding interval on Windows NT is now handled in <tt>exec/sbbsexec.ini</tt>
		<br>(<b>not</b> in <tt>ctrl/sbbs.ini</tt> or in SBBSCTRL:Telnet->Configure->External Yield)
		<br>See <i>Virtual Device Driver</i> section for more details
	<li>New option to allow socket-based file transfer protocols on *nix
	<li>Bug-fix: disable file upload/attach mode if SCFG->Message Options->Allow
		Uploads in E-mail is set to "No".<br>
		This option has been in SCFG for 10(+?) years and was never used. :-)
	<li>Better seeding of random number generator
	<li>Rework the output buffer loop to simplify slightly and fix an issue with the
		highwater/timeout being innefective when the ring buffer received many small
		writes very quickly (ie: During the "Synch" logo display)<br>
		For some reason,
		this seems to happen most on fast connections<br>
		(Possibly the socket
		implementation manages to combine the write()s on a slow connection)
	<li>If the highwater mark is <i>zero</i>, and <tt>TCP_MAXSEG</tt> is supported (BSD and Linux),<br>
		then automatically tune the highwater mark to be the <i>MSS</i> and never <i>send()</i> a buffer
		larger than that
	<li>Stale (> 24 hours old) mutex files (e.g. <tt>data/pack####.lock</tt>) are now ignored<br>
		so crashed instances with locked mutexes will no longer need manual clean-up (auto-revovery)
	<li>Bug-fix: 100% CPU utilization while sitting at Inter-BBS Instant Message menu prompt
	<li>New global JS function: <i>write_raw()</i><br> 
		used for sending strings with NULLs and other control characters to the
		remote client
	<li>Provide example RLogin <i>"Game Server"</i> option in <tt>exec/logon.js</tt> (disabled by default)
	<li>Added support for random logon screens (<tt>text/menu/random*.*</tt>) in <tt>exec/logon.js</tt>
	<li>Added <i>"E-mail Forgotten Password"</i> feature in <tt>exec/login.js</tt><br>
		Set <tt>email_passwords=false</tt> to disable
	<li>Use Deuce's xp_printf module for Baja/PCMS printf/sprintf/fprintf functions:<ul>
		<li>eliminates segfaults/AVs on incorrect usage
		<li>auto-converts arguments to correct format type
		<li>eliminates portability problems with non-x86 platforms
		</ul>
	</ul><br>
<li><b>JavaScript</b><ul>
	<li>Use Deuce's xp_printf module for all JS printf/sprintf/fprintf methods:<ul>
		<li>eliminates segfaults/AVs on incorrect usage
		<li>auto-converts arguments to correct format type
		<li>eliminates portability problems with non-x86 platforms
		</ul>
	<li><i>load(true,...)</i> (background scripts)<ul>
		<li><i>log()</i> is now available in background scripts
		<li>Bug-fix: accessing additional arguments<br>
		passed to background scripts (as <i>argv[]</i>) could cause crashes and JS errors
		<li><i>argc</i> is now always defined, even if it's 0 (zero)
		</ul>
	<li><i>console</i> object improvements:<ul>
		<li>Optionally set current attribute, as argument, to <i>clear()</i>, <i>clearline()</i> and <i>cleartoeol()</i>
			methods
		<li>Bug-fix: <i>option</i> argument didn't work in <i>telent_command()</i> method
		<li><i>ctrlkey_passthru</i> property assignment enhancement:<br>
		No longer requires "freaky numeric constants" to set <i>ctrlkey_passthru</i><br>
		Examples:<br>
		<tt>"+AB"</tt>  will add CTRL-A and CTRL-B to the set<br>
		<tt>"AB"</tt>   will change the set to only CTRL-A and CTRL-B<br>
		<tt>"-AB"</tt>  will remove both CTRL-A and CTRL-B from the set<br>
		<tt>"+A-B"</tt> will add CTRL-A to the set and remove CTRL-B<br>
		</ul>
	<li>Added <i>MsgBase</i> header object property: <i>forward_path</i> (currently not used)
	<li>Bug-fix: <i>MsgBase.remove_msg()</i> was zeroing the <i>to/from/subject</i> (and other string
		header fields)
	<li>Bug-fix: <i>Queue.peek()</i> was freeing memory it shouldn't<br>
		Resulting in crashes when the Queue was later freed or the item <i>read()</i>
	<li>Bug-fix: in <i>xtrn_area</i> object, ignore "event only" flag for external programs if event type is set
			to "None"
	<li>Bug-fix: <i>file_area.lib</i> array could contain a bogus value
	<li>New <i>file_area</i> properties: <i>sysop_dir, user_dir, upload_dir,</i> and <i>lib[x].offline_dir</i>
	<li>Bug-fix: <i>file_area.*.can_upload</i> and <i>can_download</i> properties<br>
		now take the user's <i>'D'</i> and <i>'U'</i> restrictions into account
	<li>Bug-fix: <i>msg_area.grp</i> array could contain a bogus value
	<li><i>bbs</i> object:<ul>
		<li>Bug-fix: <i>list_files()</i> and <i>list_file_info()</i> methods needed "padded" 8.3 filenames
		<li>Renamed <i>scan_posts()</i> to <i>scan_msgs()</i>, left old name as alias
		<li>New method: <i>list_msgs()</i> for various listing (as opposed to scan/reading)
			modes (text search, message to-you, etc.)
		<li>New property: <i>command_str</i> exposes the current command shell's command string ('<tt>str</tt>')
		<li>New properties: <i>cursub_code</i> and <i>curdir_code</i><br>
			to more-easily get the current sub-board or file directory internal code (string) 
		<li>New methods: <i>send_file()</i> and <i>receive_file()</i>
		<li><i>private_chat()</i> now supports an optional argument: <i>bool local</i> (default: <i>false</i>)<br>
			used for forcing user into local sysop chat (as opposed to private node-to-node chat)
		<li>Bug-fix: <i>logkey()</i>, <i>comma</i> was always true if any argument was given
		</ul>
	<li><i>User</i> class (and <i>user</i> object):<ul>
		<li>Big performance/design improvement:<br>
			User data is now cached in the user object's
			"private storage"<br>
			reducing (by a large factor) the number of unnecessary calls
			to <i>getuserdat()</i><br>
			which opens/seeks/locks/reads/closes the user data base.<br>
			This should have a profound performance improvement on web/ssjs scripts,
			especially the <tt>userlist.ssjs</tt>
		<li>New property: <i>cached</i> to reflect the current cached user data state (true/false)<br>
			and allow external manipulation if necessary
		<li>New methods to allow the atomic (safe) adjustment of numeric/statistical user fields:<ul>	
			<li>adjust_credits(count)
			<li>adjust_minutes(count)
			<li>posted_message([count=1])
			<li>sent_email([count=1] [,feedback=false])
			<li>uploaded_file(bytes [,files=1])
			<li>downloaded_file(bytes [,files=1])
			</ul>
			In the methods where "count" is optional (in square brackets), the default
			value is '1'.<br>So to increment the user's messages-posted statistcs by one
			(for today and total),<br><i>User.posted_message()</i> is all that is needed.<br>
			Specifying a negative value allows adjust downwards (subtraction).<br>
			e.g. to remove 1000 credits: <i>User.adjust_credits(-1000);</i>
			<br>
			The <i>User.stats</i> properties are <b>intentionally</b> read-only (i.e. not a bug)<br>
			since
			there is no "safe" way to modify these properties using normal mathematical
			operators (e.g. <tt>+=</tt>), hence the need for these new methods
		</ul>
	<li>New method: <i>js.get_parent()</i> a useful function for walking backward through an
		object/scope hierarchy
	<li>New property: <i>js.global</i> for easy reference to the global (top level) object
	<li>New property: <i>system.timer</i> high-resolution timer, in seconds (fractional seconds supported)
	<li>New properties: <i>system.version_num</i> and <i>system.version_hex</i><br>
		These allow easy Synchronet version comparison in scripts.<br>Example:
		<pre>
		if(system.version_num < 31301) /* v3.13b */
			print("version 3.13b or later required");</pre>
		<i>system.version_hex</i> allows easy major/minor version number checking, parsing
		or printing using right-shift operations instead of division/rounding.<br>Example:
		<pre>
			31301/100 == 313.01
			0x31301>>8 == 0x313</pre>
	<li>New property: <i>system.cmd_shell</i> for getting the current OS command processor/shell filename
	<li><i>base64_encode()</i>, <i>crc16_calc()</i>, <i>crc32_calc()</i>, <i>chksum_calc()</i> and <i>md5_calc()</i><br>
		functions now support string arguments with \0 (ASCII 0, NULL) embedded in them
	<li><i>file_mutex()</i> function now supports an optional <i>max_age</i> argument
		<br>to detect and remove stale mutex files
	<li>New function: <i>wildmatch()</i> for simplified pattern matching
			(wildcards supported: '?' and '*')
	<li>New function: <i>disk_size()</i> which reports the total number of
		bytes (or units, e.g. kilobytes)  of the disk (not just the "free space")
	<li>Bug-fix: <i>ctrl()</i> didn't toggle the correct bit for ASCII to Ctrl-char conversion
	<li>Bug-fixes: <i>quote_msg()</i> and <i>word_wrap()</i> over-hauls by Deuce
	<li>Baja modules ported to JS:<ul>
		<li>login.bin to login.js
		<li>str_cmds.bin to str_cmds.js
		<li>chat_sec.bin to chat_sec.js
		<li>default.bin to classic_shell.js
		</ul>
	<li><i>File</i> class:<ul>
		<li>Strings containing \0 (ASCII 0, NULL) can now be read from or written to files
		<li>New methods: <i>iniRemoveKey()</i> and <i>iniRemoveSection()</i> for removing elements
			from a <tt>.ini</tt> file
		<li>New method: <i>truncate()</i>
		</ul>
	<li><i>Socket</i> class:<ul>
		<li>constructor now supports an optional <i>protocol</i> string argument to specify the
			 protocol or service name the socket is to be used for<br>
			 (Used for automatically setting protocol and service-specific socket options from <tt>ctrl/sockopts.ini</tt>)
		<li>Strings containing \0 (ASCII 0, NULL) can now be read from or written to sockets 
		<li>New property: <i>option_list</i>:<br>
			an array of option names supported by the current platform and socket type combination
		<li>Bug-fix: <i>peek()</i> length wasn't initialized with default value
		<li>Get/set of <tt>SO_LINGER</tt> socket option now works like <tt>ctrl/sockopts.ini</tt>:<br>
			0 = linger disabled (no time-out value)<br>
			non-zero = time-out value (in seconds), linger enabled
		<li><i>sendfile()</i> now uses a proven implementation (from the <i>XPDEV</i> library)
		</ul>
	<li>JSexec:<ul>
		<li><tt>jsexec -v</tt> now dumps the version details and exits
		<li>Bug-fix: <i>prompt()</i> no longer returns the '<tt>\n</tt>' with the string
		<li>Now displays the number of seconds/milliseconds it took to compile
			and execute a script (if either duration is greater than 0)
		<li><i>alert()</i> now returns the string printed
		<li>The variable <i>exit_code</i> is only used for the return value <i>if</i> it's a number
		<li>Bug-fix: random number generator wasn't being seeded
		<li>New <b><i>uifc</i> object</b> for local full-screen user interface scripts (ala SCFG)
		<br>
			<i>load("uifcdefs.js")</i> for constant definitions
		<br>Methods:<ul><tt>
			<li><i>Boolean</i> init(<i>String</i> title)
			<li><i>void</i> bail()
			<li><i>void</i> msg(<i>String</i> text)
			<li><i>void</i> pop([<i>String</i> text])
			<li><i>String</i> input(mode, left, top, prompt, org_str, max_length, kmode)
			<li><i>String</i> list(mode, left, top, width, default, bar, title, Array options)
			</ul></tt>
		<br>Properties:<ul><tt>
			<li><i>Boolean</i> initialized
			<li><i>Number</i> mode
			<li><i>Boolean</i> changes
			<li><i>Number</i> save_num		
			<li><i>Number</i> screen_length
			<li><i>Number</i> screen_width	
			<li><i>Number</i> list_height	
			<li><i>Number</i> esc_delay	
			<li><i>String</i> help_text	
			<li><i>Number</i> background_color
			<li><i>Number</i> frame_color	
			<li><i>Number</i> text_color	
			<li><i>Number</i> inverse_color
			<li><i>Number</i> lightbar_color
			</ul></tt>
		</ul>
	</ul><br>
<li><b>SBBSecho</b><ul>
	<li>Netmail packets, for attach-style mailers, are now created with filenames
		of <tt>.pkt</tt> (rather than <tt>.pk_</tt>)<br>
		EchoMail packets still use the temporary file extension of <tt>.pk_</tt>
	<li>Bug-fix: NetMail packets are now correctly terminated (with 2 NULL bytes)
	<li>Bug-fix: Do not adjust for daylight savings time when generating UTC time stamps
	<li>Now strips ctrl chars (garbage) from var-length message header
		fields (i.e. to/from/subject)
	<li>Now sends AreaFix responses back to the user name that made the request (rather than "SYSOP")
	</ul><br>
<li><b>Synchronet Console</b><ul>
	<li>[Unix] Bug-fix: call <i>do_seteuid()</i> as soon as possible to avoid creating dirs/files as
		startup user (often <i>root</i>)
	</ul><br>
<li><b>Synchronet Control Panel (for Win32)</b><ul>
	<li>Now supports the <tt>ctrl/recycle[.ctrl]</tt> and <tt>ctrl/shutdown[.ctrl]</tt>
			semaphore files so:<ol>
		<li>SCFG will touch <tt>ctrl/recycle</tt> causing SBBSCTRL to reload its copy of the
			configuration files<br>
			This resolves the FAQ about why users appear to be running the wrong
			external program in the <i>Nodes</i> window<br>
			after adding/removing external programs in SCFG
		<li>The control panel can now be gracefully shutdown by touching ctrl/shutdown
		</ol>
	<li>Mail Server Configuration:<br><ul>
		<li>Display "auto" if the DNS server field is left blank or set to an invalid IP
		address or hostname
		<li>Created an "<i>Advanced</i>" tab which allows the sysop to toggle options that could
		previously only be enabled/changed in the <tt>sbbs.ini</tt> file:<ul>
			<li>SendMail: Ignore 'in transit' attribute 
			<li>Retain received mail files (in temp directory) 
			<li>Allow receipt of mail by user number 
			<li>Check 'Received' header fields against DNSBL 
			<li>Throttle DNS blacklisted server sessions
			</ul>
		</ul>
	<li>Created a right-click popup menu on the <i>File->Preview</i> window to change the
		current font
	<li>New tray-icon popup menu items to configure web server and services
	<li>New splash screen image (from Mike)
	<li>New <i>Help->Technical Support</i> menu item to load tech support web page
	<li>Added <tt>ftpbadlogin.txt</tt> to <i>FTP->Edit</i> menu
	<li>Bug-fix: Wasn't displaying the "server in use, terminate yes/no" message box
		if Synchronet NT services were installed, but disabled
	<li>Bug-fix: Exceptions/access violations while shutting down if Synchronet NT
		services were installed, but disabled
	</ul><br>
<li><b>Synchronet FOSSIL Driver (<tt>dosxtrn.exe</tt>)</b><ul>
	<li>Now provides interrupt 14h service routine "signature" required by some (very few) programs
		to detect the FOSSIL driver's presence
	<li>Bug-fix (NT only): funtion 18h is supposed to be a block-read with *no*
		wait (return immediately if no data)<br>
		we were blocking if there was no data waiting (cause of hang in <i>Star Fight</i> door game)
	<li>Bug-fix (NT only): incorrect baud rate returned in information block (function 1Bh)
	<li>Bug-fix (NT only): size of information block was off-by-one (+1) due to padding
	<li>Correct driver revision and ID string is now returned in information block (NT only)
	<li>Treat interrupt 21h function 2Ch (DOS "GET SYSTEM TIME") as a "poll" with
		potential forced yield (NT only)
		<br>this "tames" BRE down to single-digit CPU utilization!
	<li>External programs can now "hangup" (disconnect) the user<br>
		(this capability of the FOSSIL driver can be disabled in the <tt>exec/sbbsexec.ini</tt> file)
	</ul><br>
<li><b>Synchronet Windows NT Virtual Device Driver (<tt>sbbsexec.dll</tt>)</b><ul>
	<li>This driver now virtualizes (emulates) a UART (COM port):<br>
		By default, COM1 (IRQ 4, I/O Address 3F8)<br>
		This feature allows you to run DOS doors <b>without</b> FOSSIL support<br>
		This feature is configurable/disableable in <tt>exec/sbbsexec.ini</tt>, even on a per-program basis<br>
		Most programs will perform better in FOSSIL mode, but some may perform better in UART/COM Port mode
			(depends on the program)
	<li>Time-slice yielding (for both UART virtualized and FOSSIL programs) is now handled in
		<tt>exec/sbbsexec.ini</tt>, even on a per-program basis
	</ul><br>
<li><b>Synchronet NT Services</b><ul>
	<li>Bug-fix: the "SynchronetEvent" NT event log source wasn't being registered
	</ul><br>
<li><b>Synchronet Services</b><ul>
	<li>Allow log level to be configurable in <tt>ctrl/services.ini</tt> either globally (in the root
		section) or per service
		<br>using the <tt>LogLevel</tt> key (default value: "DEBUG")
	<li><tt>ctrl/services.ini</tt> now supports <tt>!include <i>filename</i></tt> directive for nested
		initialization files
	<li>Now ignores services with no configured commad-line, but logs warning
	<li>Bug-fix: when parsing the <tt>services.ini</tt> file, don't use the default <tt>NotHost</tt>
		value for host_name comparison<br>
		under some strange circumstances, the startup->host_name could be blank
	<li>Bug-fix: Now includes a working <i>readln()</i> global JS function
	</ul><br>
<li><b>ListServer</b><ul>
	<li>Bug-fix: Don't call <i>convert_msg_header()</i> inside
		<i>process_contribution()</i><br>
		the header has already been processed and is passed
		in as an argument
	<li>Implement Cyclops subject modification for exported messages<br>
		if <tt>"subject_mod = true"</tt> in the <tt>listserver.ini</tt> for the particular list
		(default: <i>false</i>)
	<li>Don't add the <tt>[listname]</tt> subject prefix if it's already in the subject string
	<li>Remove <tt>[listname]</tt> from imported subjects (list contributions)
	</ul><br>
<li><b>NewsLink</b><ul>
	<li>Bug-fix: Specifically call <i>msgbase.close()</i><br>
		fixes reported problem with
		<i>fdopen()</i> failure opening massive number of newsgroups (e.g. >170 total)
	</ul><br>
<li><b>Finger Service</b><ul>
	<li>Add support for <tt>.plan</tt> files<br>
		New <tt>;PLAN</tt> Telnet/RLogin string command (in <tt>exec/str_cmds.js</tt>) which allows
		editing of <tt>.plan</tt> files by users
	<li>Added support for abitrary "special request" files in the (optional) <tt>data/finger</tt> directory
	<li>Special finger requests can now be triggered with '.'
		(e.g. <tt>".ver@yourbbs"</tt> instead of <tt>"?ver@yourbbs"</tt>)<br>
		since some finger gateways (e.g. <tt>finger.cgi</tt>) don't like the '?'
	</ul><br>
<li><b>NNTP Service</b><ul>
	<li>If <tt>-notag</tt> option is specified on command-line<br>
		do not add tear/tagline to local
		message body text sent to Q-restricted accounts
	<li>If <tt>-ascii</tt> option is specified or the sub-board has been flagged for ASCII-only<br>
		extended-ASCII chars (in message body or subject) are converted to ASCII
		before being sent to client
	<li>Bug-fix: <i>msgbase</i> could be non-NULL even though no newsgroup had been selected<br>
		check '<i>selected</i>' instead of '<i>msgbase</i>' to determine if a msgbase has indeed been
		selected or not
	<li>Added support for the (non-RFC standard) <tt>LIST EXTENSIONS</tt> command
	<li>Bug-fix: return a <i>500</i> (syntax error) response for any <tt>"LIST etc."</tt> commands not supported
	<li>Support <tt>HDR</tt> command as well as <tt>XHDR</tt>
	<li><tt>OVER/XOVER</tt> response now contains article range
	<li>Handle spaces following NNTP commands without error (e.g. <tt>"LIST "</tt>)
	<li>Added support for <tt>"LIST NEWSGROUPS"</tt> command (from RFC 2980)
	<li>Added support for wildcard matching for RFC 2980 commands that support
		<i>[wildmat]</i> arguments<br>only * and ?, not complete WILDMAT pattern syntax
	<li>Bug-fix: support passwords with spaces in them
	</ul><br>
<li><b>IRC Daemon</b><ul>
	<li>Lots of bug-fixes and enhancements by Cyan
	<li>For details, see
		<a href="http://cvs.synchro.net/cgi-bin/viewcvs.cgi/exec/ircd.js">ircd.js</a>,
		<a href="http://cvs.synchro.net/cgi-bin/viewcvs.cgi/exec/ircd_user.js">ircd_user.js</a>,
		<a href="http://cvs.synchro.net/cgi-bin/viewcvs.cgi/exec/ircd_channel.js">ircd_channel.js</a>,
		<a href="http://cvs.synchro.net/cgi-bin/viewcvs.cgi/exec/ircd_server.js">ircd_server.js</a> and
		<a href="http://cvs.synchro.net/cgi-bin/viewcvs.cgi/exec/ircd_unreg.js">ircd_unreg.js</a>
	</ul><br>
<li><b>Documentation</b><ul>
	</ul><br>
<li><b>Message Bases</b> (SMBLIB v2.41)<ul>
	<li>New function: <i>smb_updatemsg()</i><br>
		used to safely update the header and index records of a message
	<li><i>smb_putmsg()</i> now calls <i>smb_init_idx()</i> automatically to initialize or
		re-synchronize the index fields with the header fields<br>
		no longer need to call <i>smb_init_idx()</i> from <i>smb_addmsg()</i> and other places
		(e.g. <i>FIXSMB</i>)
	<li>Moved <i>smb_init_idx()</i> from <tt>smbhash.c</tt> to <tt>smblib.c</tt>
	<li><i>smb_dump_msghdr()</i> now displays the to/from/replyto network address header fields in a human-readable format
	<li>If <i>smb_getmsgidx()</i> is called with a negative offset, it actually sets the
		correct offset (from the beginning of the index) in the msg struct
	<li><i>smb_putmsgidx()</i> will now return an error if asked to write to an index record
		offset past the end of the file (typically leaving a "hole" of zeroes in the
		index file)
	<li><i>smb_putmsgidx()</i> and <i>smb_putmsghdr()</i> now returns the result of the final
		<i>fflush()</i> call (normally 0, same as <tt>SMB_SUCCESS</tt>)
	<li>Bug-fix: <i>smb_tzutc()</i> - subtract 60 minutes from US timezones with DST in
		effect
	</ul><br>
<li><b>SCFG</b><ul>
	<li>Saving changes in SCFG now recycles all services and services<br>
		including the Web server
		<b>and</b> the Synchronet Control Panel (no manual reload of configuration required)
	<li>Changed default <tt>zip/unzip</tt> command-lines to use
	<i><a href="http://www.info-zip.org/">Info-ZIP</a></i> instead of
	<i><a href="http://pkware.com/">PKZIP</a></i>
	<li>New option to allow <i>socket-based</i> (instead of stdio-based) file transfer protocols on *nix
	<li>Bug-fix: imported internal codes (from <tt>subs.txt</tt> or <tt>dirs.txt</tt>) had non-alphanum
		chars removed if > 7 chars instead of > 8 chars 
	<li>New File <i>"Import Areas..."</i> option to automatically generate the <tt>DIRS.RAW</tt>
		file (if it doesn't exist)<br>
		or just create a temp directory listing file to import "invisibly"
	<li>Bug-fix: clear "event only" flag for external programs when setting event type
		to "None"
	</ul><br>
<li><b>ADDFILES</b><ul>
	<li>Unix-friendly command-line syntax for specifying uploader's name (now <tt>-x<i>name</i></tt>)
		and enabling auto-add ('-' in place of directory code or '-<i>filename</i>')
	<li>Bug-fix: added support for the <tt>%@</tt> command-line specifier
	</ul><br>
<li><b>SEXYZ</b><ul>
	<li>Added control over how filenames are written to the <i>DSZLOG</i>, via the <tt>sexyz.ini</tt> file <tt>[DSZLOG]</tt> section:<ul>
		<li>the <tt>Path</tt> key controls whether the full path is logged
		<li>the <tt>Short</tt> key controls whether the <i>Micros~1 shortened</i> <tt>path/filename</tt> is logged
			(on <i>Windows only</i>)
		<li>the <tt>Quotes</tt> key controls whether the filename is logged in
			double-quotes (for EleBBS long filename compatibility)
			<br>
			Note: The "Quotes" feature can also be enabled with the "-quotes" command-line
			option
		</ul>
	</ul><br>
<li><b>SMBUTIL</b><ul>
	<li>New command: <tt>x</tt>, used to dump a message base index
	</ul><br>
<li><b>CHKSMB</b><ul>
	<li>Verify that if the <i>index.to</i> field is non-zero or there's a <i>to_ext</i> header field,
		that they match<br>
		This will catch a QWK networking bug in previous
		Synchronet versions where the <i>index.to</i> was non-zero<br>
		(the number of the QWKnet node account), but there was no <i>hdr.to_ext</i> field<br>
		thus the index could not be recreated from the information in the header
		(e.g. by <tt>fixsmb</tt>).<br>
		This was actually an intentional design decision at the time, but in hindsight,
		it's a bug<br>
		(the index file is not supposed to contain any unique information)
	</ul><br>
<li><b>MAKEUSER</b><ul>
	<li>Prevent crash (NULL-dereference) on invalid command-line syntax (e.g. -S50)
	<li>Sets <tt>AUTOTERM</tt> (automatic terminal type detection) in <i>user.misc</i> for new users
	</ul><br>
<li><b>New GTK Utilities (Unix only)</b><ul>
	<li>Three new experimental GTK+ based utilities have been added to the default *nix build.<br>
		These utilities require read/write access to the sbbs directories.<br>
		They do NOT need to be running on the same machine.<ul>
		<li><b>gtkmonitor</b> - Based loosely on the Win32 control panel without the log output.<br>
			Shows current activity and allows some sysop control.</li>
		<li><b>gtkuseredit</b> - Based on the Win32 useredit utility allows editing of users</li>
		<li><b>gtkuserlist</b> - Lists users supporting ARS filters and allows quick validation sets<br>
			to be applied to multiple users simultaneously.</ul>
	<li>These utilities are lightly tested and require GTK+ and Glade libraries and headers to be installed at the time of the Synchronet build.</ul><br>
<li><b>Miscellaneous</b><ul>
	<li>SLOG (System/Node Statistics Log Viewer) utility ported to 32-bit (by Deuce)
	<li>ALLUSERS (Bulk User Editor) utility ported to 32-bit (by Deuce)
	<li>DELFILES (Remove expired/offline files) utility ported to 32-bit (by Deuce)
	<li>ANS2ASC and ASC2ANS now support '-' in place of a filename on the command-line
		to specify standard in/out instead of a file
	</ul><br>
</ul>
For <b>many</b> more changes since v3.10, see <a href="v311_new.html">v311_new.html</a>,
<a href="v312_new.html">v312_new.html</a>,
and <a href="v313_new.html">v313_new.html</a>
<p align="right"><font face="Arial" size="1" , "Helvetica">Copyright © 2005 Rob 
Swindell <br>
&nbsp;$Id$</font></p>

</body>
</html>
