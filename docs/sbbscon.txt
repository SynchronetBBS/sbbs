Synchronet Console Documentation
================================

$Id$

1. Introduction
---------------
The Synchronet Console is the console-mode sysop interface to Synchronet v3.
On Win32 operating systems, this interface (sbbs.exe) is an alternative to 
the graphical Synchronet Control Panel (sbbsctrl.exe). On Unix, this interface
(sbbs) is currently the only option.

On Win32 operating systems, the exact same underlying server libraries (DLLs)
are used to service the clients, so from the users perspective there should
be no difference in performance or functionality. The console mode interface
does use fewer system resources than the graphical control panel, so for some
sysops that wish to conserve system resources, this may be the preferred
interface.


2. BBS Configuration
--------------------
The system-wide configuration files (ctrl/*.cnf) are edited using the
Synchronet configuration utility (SCFG). The executable filename is 
exec/scfg.exe on Win32 and exec/scfg on Unix.

SCFG needs to be told the location of your Synchronet ctrl directory, where
it expects to find the Synchronet configuration (.cnf) files. This can be done
by passing the path to your ctrl directory on the SCFG command line, example:

	scfg /sbbs/ctrl

or by setting the SBBSCTRL environment variable before running SCFG.  Example:

Unix (bash):	export SBBSCTRL=/sbbs/ctrl
Unix (sh):	SBBSCTRL=/sbbs/ctrl && export SBBSCTRL
Unix (csh):	setenv SBBSCTRL /sbbs/ctrl
Win32:		set SBBSCTRL=/sbbs/ctrl

Generally speaking, if you are running Linux, your shell is bash.  You can
verify your shell by typing ``echo $SHELL'' at a command line.

Many of the Synchronet utilities require this environment variable, so it is
suggested you initialize this environment variable in your system startup 
and/or login scripts. See section 3 for details.

The SCFG application supports multiple forms of user interface. The default
interface is currently curses/conio (full-screen colored text). To use a
different interface, use the -G (graphical) or -D (stdio) command-line
options. There are other command-line options to control the character set
used, escape key delay, monochrome/color mode, etc. Type "scfg -?" to list
all the available command-line options.

There are other system-configuration files that are simple text files to be
edited using any ASCII text editor: ctrl/*.cfg and text/*.can. Each of
these files should contain a description of its purpose and usage.


3. Initializing the SBBSCTRL Environment Variable
-------------------------------------------------
For Windows NT-based operating systems, goto the Windows Control Panel->
System->Advanced->Environment Variables->System Variables->New...
	Variable:		SBBSCTRL
	Variable Value:		c:\sbbs\ctrl (or wherever is correct)

For Windows 9x-based operating systems, edit your C:\AUTOEXEC.BAT file
and add the line:
	SET SBBSCTRL=c:\sbbs\ctrl (or wherever is correct)

For Unix bash/sh:
In the home directory of the user the BBS will be running as, edit the file
name either .profile or .bash_profile depending on if you're running bash or
sh and add the line:

    SBBSCTRL=/sbbs/ctrl && export SBBSCTRL
    (replace /sbbs/ctrl with the full path to your ctrl directory)

For Unix csh/tcsh:
Again, in the home directory of the user the BBS will be running as, in the file
named .tcshrc (for tcsh) or .cshrc (for csh) add the line:

    setenv SBBSCTRL /sbbs/ctrl
    (replace /sbbs/ctrl with the full path to your ctrl directory)


4. Server Configuration
-----------------------
The server/host-specific configuration options are set with sbbs command-line
options (run "sbbs help" for a list), or by editing the Synchronet
Initialization file (e.g. ctrl/sbbs.ini).


4.1 Initialization File
-----------------------
The default initalization file is ctrl/sbbs.ini. A different initialization 
(.ini) filename may be used by specifying the path and filename on the sbbs
command-line. Example:

	sbbs /sbbs/ctrl/mybbs.ini

If the path and filename of the initialization file is not passed on the
command-line, sbbs will use the SBBSCTRL environment variable to determine
the location of your Synchronet ctrl directory, where it expects to find
either <HOSTNAME>.ini or sbbs.ini.


4.2 For Unix Sysops
--------------------
You will particularily want to pay attention to the [UNIX] section of sbbs.ini
if you do not want to run Synchronet (and all doors!) as root (You don't), you
will have to set the User= and Group= lines.

If you wish the program to fork and run in the background as a daemon, logging
via syslog, Set Daemonize=True in this section.

The use of the LogFacility setting is beyond the scope of this document.
Read your syslog.conf manpage for more information about this.  In particular,
do NOT use the 'S' setting unless you are familiar with advanced syslogd
configuration.  The S setting will use different facilities for each feature
of Synchronet as appropriate.  Specifically, S will use:

    LOG_AUTH
    LOG_DAEMON
    LOG_FTP (If available)
    LOG_MAIL
    LOG_CRON


4.3 Terminal Capabilities
-------------------------
As you have probobly noticed by now, most telnet programs designed for BBSes
do not display screens in *nix programs correctly.  Included with Synchronet
is a pair of files to enable you to run native *nix programs and have the
output be useable in standard BBS terminals.  These files are termcap and
terminfo.  Your system will use one of the other, and it won't hurt to install
both.  You will need to be root.

Installing the terminfo:
------------------------
1) Change to the directory which contains the terminfo file.
2) enter the command ``tic terminfo''

Installing the termcap:
-----------------------
1) Change to the directory which contains the termcap file
2) Enter the command ``cat termcap >> /etc/termcap''
3) *** FreeBSD Only *** run the command:
	``cap_mkdb -f /usr/share/misc/termcap.db /etc/termcap''

Once they are installed, edit the ExternalTerm line in your *.ini file to read:
    ExternalTerm=ansi-bbs


5. Running Synchronet
---------------------
If you've initialized the SBBSCTRL environment variable and edited your BBS
and server configuration, you are now ready to run Synchronet. You can do
this by simply running exec/sbbs (off of the installation directory).

If you want Synchronet to start automatically whenever your system boots,
you will need to set that up using the system rc scripts.  A few example are:

FreeBSD:
--------
1) Set up your BBS to run as a daemon, make SURE it works.

2) Create the following file as /usr/local/etc/rc.d/synchronet.sh owned by
   root, and chmod 555:

--- CUT --- /usr/local/etc/rc.d/synchronet.sh --- CUT ---
#!/bin/sh

# Replace the path in the following line with your sbbs install DIR
SBBSDIR=/sbbs

case "$1" in
start)
        echo -n 'sbbs '
        cd /usr/bbs/sbbs/exec
        export SBBSCTRL=$SBBSDIR/ctrl
        export SHELL=/bin/sh
        ./sbbs
        ;;
stop)
        echo "Shutting down Synchronet... "
        kill `cat /var/run/sbbs.pid`
        while ps -p `cat /var/run/sbbs.pid` > /dev/null
        do      sleep 1
        done
        ;;
*)
        echo "Usage: `basename $0` {start|stop}" >&2
        ;;
--- CUT --- END OF FILE --- CUT ---

/* End of sbbscon.txt */
